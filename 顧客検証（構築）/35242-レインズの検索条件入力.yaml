# テキストを作成
+text_1:
  action>: Text
  text: "■登録年月日\n\n・開始年:　//span[text()=\"登録年月日\"]/../following-sibling::div[2]//input[1]\n﻿・開始月:　//span[text()=\"登録年月日\"]/../following-sibling::div[2]//input[2]\n﻿・開始日:　//span[text()=\"登録年月日\"]/../following-sibling::div[2]//input[3]\n\n・終了年:　//span[text()=\"登録年月日\"]/../following-sibling::div[2]/div[3]//input[1]\n﻿・終了月:　//span[text()=\"登録年月日\"]/../following-sibling::div[2]/div[3]//input[2]\n﻿・終了日:　//span[text()=\"登録年月日\"]/../following-sibling::div[2]/div[3]//input[3]\n\n■成約年月日\n\n・開始年:　//span[text()=\"成約年月日\"]/../following-sibling::div[2]//input[1]\n﻿・開始月:　//span[text()=\"成約年月日\"]/../following-sibling::div[2]//input[2]\n﻿・開始日:　//span[text()=\"成約年月日\"]/../following-sibling::div[2]//input[3]\n\n・終了年:　//span[text()=\"成約年月日\"]/../following-sibling::div[2]/div[3]//input[1]\n﻿・終了月:　//span[text()=\"成約年月日\"]/../following-sibling::div[2]/div[3]//input[2]\n﻿・終了日:　//span[text()=\"成約年月日\"]/../following-sibling::div[2]/div[3]//input[3]"

# ページ内でJavaScriptを実行する
+inject_script_1:
  action>: InjectScript
  browser: +text_1
  code: "//XPathで要素取得\nfunction xpath(path) {\n  let element = document.evaluate(\n    path, \n    document, //開始する要素\n    null, \n    XPathResult.ORDERED_NODE_ITERATOR_TYPE, //戻り値の種類\n    null\n  );\n  return element.iterateNext();\n}\n\nlet reins = class {\n  constractor() {\n    this.event = null;\n  }\n  //クリック処理\n  click(sel) {\n    let el = xpath(sel);\n    if(!!el) {\n      el.click();\n      el.dispatchEvent(new MouseEvent(\"change\"));\n    }\n  }\n  //プルダウン処理\n  selectOption(sel, option) {\n    let el = xpath(sel);\n    let options = el.querySelectorAll('option');\n    options.forEach(x => {\n      let content = x.innerText;\n      if(content === option) x.selected = true;\n    });\n    el.dispatchEvent(new MouseEvent(\"change\"));\n  }\n  //文字入力処理　\n  typeText(sel, text) {\n    let el = xpath(sel);\n    el.value = text;\n    el.dispatchEvent(new MouseEvent(\"change\"));\n  }\n};\nlet obj = new reins();\nobj.click('//label[text()=\"${search_type}\"]');\nobj.selectOption('//span[text()=\"物件種別１\"]/../following-sibling::div/select', '${propertyType_1}');\nsetTimeout(()=>{\n  obj.selectOption('//span[text()=\"物件種目１\"]/../following-sibling::div/select', '${propertyEvent_1}');\n  obj.selectOption('//span[text()=\"物件種目２\"]/../following-sibling::div/select', '${propertyEvent_2}');\n}, 2000);\nobj.click('//span[text()=\"新築・中古区分\"]/../following-sibling::div//label[text()=\"${new_used_classifycation}\"]');\nobj.click('//span[text()=\"土地権利/借地権種類\"]/../following-sibling::div//label[text()=\"${landRights}\"]');\nobj.click('//span[text()=\"その他の条件\"]/../following-sibling::div//label[text()=\"${another}\"]');\nobj.typeText('//span[text()=\"都道府県名\"]/../following-sibling::div//input', '${prefecture_1}');\nobj.typeText('//span[contains(text(),\"所在地名１\")]/../following-sibling::div//input', '${address_1}');\nobj.typeText('//span[contains(text(),\"建物名\")]/../following-sibling::div//input', '${buildingName_1}');\nobj.typeText('//span[contains(text(),\"価格\")]/../following-sibling::div//input', '${price_min}');\nobj.typeText('//span[contains(text(),\"価格\")]/../following-sibling::div/div[4]//input', '${price_max}');\nobj.typeText('//span[contains(text(),\"坪単価\")]/../following-sibling::div//input', '${pyeongUnit_min}');\nobj.typeText('//span[contains(text(),\"坪単価\")]/../following-sibling::div/div[4]//input', '${pyeongUnit_max}');\nobj.typeText('//span[contains(text(),\"専有面積\")]/../following-sibling::div//input', '${area_min}');\nobj.typeText('//span[contains(text(),\"専有面積\")]/../following-sibling::div/div[4]//input', '${area_max}');\n\nfor(let floorPlan of ${JSON.stringify(floorLayoutArray)}) {\n  obj.click('//label[text()=\"' + floorPlan + '\"]');\n}\n\nobj.typeText('//span[text()=\"築年月\"]/../following-sibling::div//select', '${year_old}');\nobj.typeText('//span[text()=\"築年月\"]/../following-sibling::div/div[2]//select', '${month_old}');\nobj.typeText('//span[text()=\"築年月\"]/../following-sibling::div/div[5]//select', '${year_new}');\nobj.typeText('//span[text()=\"築年月\"]/../following-sibling::div/div[6]//select', '${month_new}');\nobj.click('//span[text()=\"登録年月日\"]/../following-sibling::div//label[text()=\"３日以内\"]/../input');\n"
  returnValue: false